## Introduction

Metalloproteins are ubiqutious in nature and are present in all major enzyme familes. The metals typically found in biological systems are the first and second row alkali and earth alkali metals and the first row transition metals. The most common metal found in biologocial systems is Zinc (present in ~10% of deposited structures )<!-- ZN ligand in  18889 structures, 187844 total structures deposited in PDB. Considering all Zn-containing structures, the number is unchanged in practice (18923/187844=10%)-->In proteins, zinc is found as the redox inert Zn(2+) cation with electronic configuration [Ar]3d<sup>10</sup>. Zinc can fulfill both a  structural role (e.g in Zinc finger proteins) or a catalytic role in up to trinuclear active sites. Zn<sup>2+</sup> is an excellent Lewis acid and is most often found in tetrahedral, pentavalent or octahedral coordination. In enzymes often a tetrahedral site is found that has an exogenous ligand (water, substrate) bound.

Metalloproteins are well studied because metall cofactors are essential for the function of many proteins. Many metalloproteins are also involved diseases [@doi:10.1038/s42256-019-0119-z]. Metalloproteins are also interesting for use in industrial applications because existing metal ion binding sites can be rapidly tuned using directed Evolution to catalyse a desired chemical reaction [@doi:10.1126/science.aau3744, @doi:10.1021/bi201881p, @doi:10.1039/C5SC01065A] utilizing the catalytic properties of the metal for the catalysis and the shape and polarity of the binding pocket for substrate/enantiomer selectivity. To crystalyze proteins, metals are also often added to the crystallization buffer as they can help in the formation of protein crystals overcoming the enthalpic cost of association of protein surfaces.  Metal ion binding sites can also be used to rapdily engineer protein-protein interactions (PPI) and the hypothesis has been put forward that one orgin of macromolecular complexity is the superfacial binding of metal ions in early single domain proteins. Many metal ion binding sites are still found at interfaces. 

While simple metal ion binding sites can be rapidly engineered because intial coordination on a protein surface can for example be achieved by creating an i, i+4 di-histidine site [@doi:10.1002/anie.202009226] or by placing thiol residues in spatial proximity [@doi:10.1038/nchem.1201] the engineering of complex metal ion binding sites is considerably more difficult [@doi:10.1093/protein/gzw026] as such sites are often supported by a network of hydrogen bonds. A complication for computational design of metalloproteins is the unavailability of good non-bonded force fields for transition metals that accurately reproduce the coordination number and coordination distances which renders design e.g using Rosetta very difficult [@doi:10.1093/protein/gzw026]. To treat metal sites in proteins adequately quantum mechanical treatment such as in hybrid quantum mechanics/molecular mechanics simulations [@doi:10.1021/cr500628b] is needed whose computational cost is prohibitive for regular protein design tasks. QM/MM simulations can however be used to verify coordination chemistry for select candidate proteins [@doi:10.1021/jacs.7b10660]. 

Many tools exists to predict whether a protein contains metals (ZincFinder [@doi:10.1186/1471-2105-8-39]), which residues in the protein bind a metal (IonCom [@doi:10.1093/bioinformatics/btw396], MIB) and where the metal is bound (AlphaFill [@doi:], FindsiteMetal [@doi:10.1002/prot.22913],BioMetAll [@doi:10.1021/acs.jcim.0c00827] ). The input for these predictors is based on sequence and/or structure. Sequence-based predictors are mostly based on scanning the sequence of a target protein to identify the regions where amino acid patterns match a metal-binding site fingerprint. 
On the other hand, structure-based methods are based on the geometrical 3D structure, either using homology to known structures (MIB, Findsite-metal, AlphaFill) or distance features (BioMetAll) to infer the location of metals. Some tools like Findsite-metal employ machine learning based approaches but currently there is no tool to use deep learning to predict metal location. 
Modern deep learning approaches have the advantage that they do not rely on careful feature extraction/engineering to extract relevant features. Deep learning based approaches have been used  in the field of protein research for a variety of applications such as protein structure prediction [@doi:10.1038/s41586-021-03819-2, @doi:10.1126/science.abj8754], prediction of identity of masked residues [@doi:10.1186/s12859-017-1702-0; @doi:10.1021/acssynbio.0c00345; @doi:10.1038/s41467-022-28313-9 ]), for ranking of docking poses [@doi:10.1038/s41467-021-27396-0; @doi:10.1038/s41592-019-0666-6], prediction of the location of complex organic ligands [@doi:10.1093/bioinformatics/btx350; @doi:10.1093/bioinformatics/bty583; @doi:10.48550/arXiv.2202.05146 ; @doi:10.1038/s41592-019-0666-6] and prediction of effects of mutations for stability and disease [@doi:10.1038/s42256-019-0119-z, @doi:10.1371/journal.pcbi.1008291]. Most of those models are based on 3D convolutional neural networks (CNN). Methods using geometric deep learning (on surfaces or graphs) are the most recent and often only use approximate (AlphaFold IPA) or no explicit sidechain information (EquiDock). 

Current state of the art predictors for metal-binding sites are MIB [@doi:10.1371/journal.pone.0039252,@doi:10.1021/acs.jcim.6b00407], which combines structural and sequence information in the "Fragment Transformation Method" to search for homologus sites in its database, and BioMetAll [@doi:10.1021/acs.jcim.0c00827], a geometrical predictor based on backbone preorganization. Both methods have significant drawbacks. MIB excluded metal sites with less than 3 <!--Check --> coordination partners from its analysis and is limited by the availability of templates in the protein databank. BioMetAll does not use templates but provides many possible locations for metals with some overlapping the protein. <!--  The reported accuracy and sensitivity for the MIB predictor are 94.6% and 64.7%, respectively (average values on different metal ions, for Zn<sup>2+</sup> in particular the corresponding values are 94.8% and	71.1%). For the BioMetAll predictor, the same quantities are not available, but a benchmark on 53 two-histidine one-carboxylate motifs resulted in an average distance between the predicted and the experimental site of the metal of (0.56±0.19)Å Put cluster center instead of one of the probe. These values refer to the performances assessed in the original publications, but are not straightforward to compare and extend to the general case. For this reason, in this work we also performed a robust and fair comparison of our two novel methods with MIB and BioMetAll predictors. -->
In this work, we present two metal ion location predictors that do not suffer from these drawbacks. The deep learning based Metal3D predictor operates on a voxelixed representation of a protein environment and predicts a metal probability density. The distance based predictor Metal1D predicts the location of metals using distances mined from the protein databank. 
These tools pave the way to perform in silico design of metal ion binding sites without relying on predefined geometrical rules or expensive quantum mechanical calculations. 

<!-- 

many biological functions [Percora review]? 
As oneof the most prevalent transition metal cofactors in
biological systems, it plays structural, signaling, and regulatory
roles and is found in all six classes of enzymes (most commonly
hydrolases



Understanding where metals bind in biology is related to health [@doi:10.1038/s42256-019-0119-z], biocatalyis [Kuhlman, Hilvert] and PPIs [Tezcan]. 

Starting with pioneering studies in the 1990 s,[@doi:10.1126/science.8346440;@doi:10.1146/annurev.biochem.68.1.779]there have been notable successes inthe de novo design of functional metalloproteins, which arepredominantly based on four-helix bundle anda-helicalcoiled-coiled motifs with readily parametrizable structure [@doi:10.1002/anie.202009226]. 


Zinc exists as a redox-inert Zn(II) cation with an electron configuration of [Ar]3d10
These properties with the lack of ligand field effects make zinc an excellent metal for different coordination numbers and binding geometries in different biological systems.
 Zinc can be found as an active site metal (cofactor) in all six IUBMB enzyme classes
### Deep learning on proteins
Torng/Shroff 3DCNN bio stuff 
Ananad DeepRank
Correia surface studies Nat Methods 


### Enzymes

### Interfaces
It has been hypothesized that some modern metalloproteins may have emerged through the metal-nucleated oligomerization of small peptides or protein domains, followed by the evolution of the resulting assemblies into stable, functional architecture.


Metal-Templated Interface Redesign (MeTIR) ). These strategies, inspired by both the proposed evolutionary roles of metals and their prevalence in natural PPIs, take advantage of the favorable properties of metal coordination (bonding strength, directionality, and reversibility) to guide protein self-assembly with minimal design and engineering

In order to circumvent the complexity of constructing extensive noncovalent interfaces, which are typically involved in natural PPIs

### Existing approaches

Computational predictors of metal-binding sites built on sequence analyses are mostly based on scanning the sequence of a target protein to identify those regions where amino acid patterns match a metal-binding site fingerprint. For zinc binding sites often two histidine spaced by one residue which allows to readily detect the motif are easy to detect. These predictors yield the identites of the coordinating residues. 

Structural detectors often used distance features to identify sites based on statistical mining in the protein databank.  Predictors trained like this can identify highly preorganized motifs (e.g 4x Cys in close spatial proximity) but are often not very good at identifying weakly preorganized motifs. Current state of the art predictors (MIB, BioMetAll) use fragments/homology to predict the location of the metal or backbone preorganization predicting an approximate position of the metal that is less sensitive to the exact side chain geometry thus affording higher sensitivity to detect metal sites(BioMetAll). MIB [@doi:10.1021/acs.jcim.6b00407] uses the fragmentation transformation method to search for homologus sites in its database


In our work we develop two new predictors primarily intended for zinc binding sites - Metal1D and Metal3D that are more accurate and sensitive than existing approaches in predicting metal ion binding sites. We evaluate their capability with respect to  -->

